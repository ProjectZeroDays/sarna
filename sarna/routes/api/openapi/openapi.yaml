openapi: 3.0.1
info:
  contact:
    email: rsrdesarrollo@gmail.com
  description: API of SARNA (https://github.com/rsrdesarrollo/sarna/)
  license:
    name: GPLv3
    url: https://www.gnu.org/licenses/gpl.txt
  title: SARNA API
  version: 1.0.0
servers:
- description: Development Server
  url: http://localhost:5000/api/v1
security:
- bearerAuth: []
tags:
- description: Everything about your clients
  name: client
- description: Access Finding database
  name: finding
- description: Operate with assessments
  name: assessment
- description: System Users
  name: user
paths:
  /client:
    get:
      operationId: get_clients
      parameters:
      - description: Number of page
        explode: true
        in: query
        name: page
        required: false
        schema:
          default: 0
          format: int32
          minimum: 0
          type: integer
        style: form
      - description: Number of items returned
        explode: true
        in: query
        name: page_size
        required: false
        schema:
          default: 10
          format: int32
          maximum: 100
          minimum: 10
          multipleOf: 10
          type: integer
        style: form
      responses:
        200:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/PaginatedEnvelop'
                - properties:
                    data:
                      items:
                        $ref: '#/components/schemas/Client'
                      type: array
                  type: object
          description: List of clients
      summary: Get a list of clients
      tags:
      - client
      x-openapi-router-controller: sarna.routes.api.controller.client_controller
    post:
      operationId: create_client
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ClientRequestBody'
        description: The client to create.
        required: true
      responses:
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        201:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/Envelop'
                - properties:
                    data:
                      $ref: '#/components/schemas/Client'
                  type: object
          description: Client data
      summary: Create a new client
      tags:
      - client
      x-openapi-router-controller: sarna.routes.api.controller.client_controller
  /client/{client_id}:
    delete:
      operationId: delete_client
      parameters:
      - description: Client ID
        explode: false
        in: path
        name: client_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        204:
          description: No Content
      summary: Delete client
      tags:
      - client
      x-openapi-router-controller: sarna.routes.api.controller.client_controller
    get:
      operationId: get_client
      parameters:
      - description: Client ID
        explode: false
        in: path
        name: client_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        200:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/Envelop'
                - properties:
                    data:
                      $ref: '#/components/schemas/Client'
                  type: object
          description: Client data
      summary: Get client data
      tags:
      - client
      x-openapi-router-controller: sarna.routes.api.controller.client_controller
    patch:
      operationId: modify_client
      parameters:
      - description: Client ID
        explode: false
        in: path
        name: client_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ClientRequestBody'
        description: The client to create.
        required: true
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        204:
          description: No Content
      summary: Modify client
      tags:
      - client
      x-openapi-router-controller: sarna.routes.api.controller.client_controller
  /client/{client_id}/assessment:
    get:
      operationId: get_client_assessments
      parameters:
      - description: Client ID
        explode: false
        in: path
        name: client_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      - description: Number of page
        explode: true
        in: query
        name: page
        required: false
        schema:
          default: 0
          format: int32
          minimum: 0
          type: integer
        style: form
      - description: Number of items returned
        explode: true
        in: query
        name: page_size
        required: false
        schema:
          default: 10
          format: int32
          maximum: 100
          minimum: 10
          multipleOf: 10
          type: integer
        style: form
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        200:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/PaginatedEnvelop'
                - properties:
                    data:
                      items:
                        $ref: '#/components/schemas/Assessment'
                      type: array
                  type: object
          description: Client Assessments data
      summary: Get list of assessment of the client
      tags:
      - client
      x-openapi-router-controller: sarna.routes.api.controller.client_controller
    post:
      operationId: create_assessment
      parameters:
      - description: Client ID
        explode: false
        in: path
        name: client_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AssessmentRequestBody'
        description: The assessment to create.
        required: true
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        201:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/Envelop'
                - properties:
                    data:
                      $ref: '#/components/schemas/Assessment'
                  type: object
          description: Client Assessment data
      summary: Create a new assessment for client
      tags:
      - client
      x-openapi-router-controller: sarna.routes.api.controller.client_controller
  /client/{client_id}/template:
    get:
      operationId: get_client_templates
      parameters:
      - description: Client ID
        explode: false
        in: path
        name: client_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      - description: Number of page
        explode: true
        in: query
        name: page
        required: false
        schema:
          default: 0
          format: int32
          minimum: 0
          type: integer
        style: form
      - description: Number of items returned
        explode: true
        in: query
        name: page_size
        required: false
        schema:
          default: 10
          format: int32
          maximum: 100
          minimum: 10
          multipleOf: 10
          type: integer
        style: form
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        200:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/PaginatedEnvelop'
                - properties:
                    data:
                      items:
                        $ref: '#/components/schemas/Template'
                      type: array
                  type: object
          description: Client Assessments data
      summary: Get list of assessment of the client
      tags:
      - client
      x-openapi-router-controller: sarna.routes.api.controller.client_controller
    post:
      operationId: add_client_template
      parameters:
      - description: Client ID
        explode: false
        in: path
        name: client_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      requestBody:
        content:
          multipart/form-data:
            schema:
              allOf:
              - $ref: '#/components/schemas/Template'
              - properties:
                  file:
                    format: binary
                    type: string
                type: object
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        204:
          description: No Content
      summary: Add template to client
      tags:
      - client
      x-openapi-router-controller: sarna.routes.api.controller.client_controller
  /client/{client_id}/template/{filename}:
    delete:
      operationId: delete_client_template
      parameters:
      - description: Client ID
        explode: false
        in: path
        name: client_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      - description: Filename
        explode: false
        in: path
        name: filename
        required: true
        schema:
          type: string
        style: simple
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        204:
          description: No Content
      summary: Delete template from client
      tags:
      - client
      x-openapi-router-controller: sarna.routes.api.controller.client_controller
    get:
      operationId: get_client_template
      parameters:
      - description: Client ID
        explode: false
        in: path
        name: client_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      - description: Filename
        explode: false
        in: path
        name: filename
        required: true
        schema:
          type: string
        style: simple
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        200:
          content:
            application/octet-stream:
              schema:
                format: binary
                type: string
          description: File data
      summary: Download Client template
      tags:
      - client
      x-openapi-router-controller: sarna.routes.api.controller.client_controller
  /assessment:
    get:
      operationId: get_assessments
      parameters:
      - description: Number of page
        explode: true
        in: query
        name: page
        required: false
        schema:
          default: 0
          format: int32
          minimum: 0
          type: integer
        style: form
      - description: Number of items returned
        explode: true
        in: query
        name: page_size
        required: false
        schema:
          default: 10
          format: int32
          maximum: 100
          minimum: 10
          multipleOf: 10
          type: integer
        style: form
      responses:
        200:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/PaginatedEnvelop'
                - properties:
                    data:
                      items:
                        $ref: '#/components/schemas/Assessment'
                      type: array
                  type: object
          description: List of assessments
      summary: Get a list of assessments
      tags:
      - assessment
      x-openapi-router-controller: sarna.routes.api.controller.assessment_controller
  /assessment/{assessment_id}:
    delete:
      operationId: delete_assessment
      parameters:
      - description: Assessment ID
        explode: false
        in: path
        name: assessment_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        204:
          description: No Content
      summary: Delete Assessment
      tags:
      - assessment
      x-openapi-router-controller: sarna.routes.api.controller.assessment_controller
    get:
      operationId: get_assessment
      parameters:
      - description: Assessment ID
        explode: false
        in: path
        name: assessment_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        200:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/Envelop'
                - properties:
                    data:
                      $ref: '#/components/schemas/Assessment'
                  type: object
          description: Assessment data
      summary: Get assessment data
      tags:
      - assessment
      x-openapi-router-controller: sarna.routes.api.controller.assessment_controller
  /assessment/{assessment_id}/findig:
    get:
      operationId: get_assessment_findingis
      parameters:
      - description: Assessment ID
        explode: false
        in: path
        name: assessment_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      - description: Number of page
        explode: true
        in: query
        name: page
        required: false
        schema:
          default: 0
          format: int32
          minimum: 0
          type: integer
        style: form
      - description: Number of items returned
        explode: true
        in: query
        name: page_size
        required: false
        schema:
          default: 10
          format: int32
          maximum: 100
          minimum: 10
          multipleOf: 10
          type: integer
        style: form
      responses:
        200:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/PaginatedEnvelop'
                - properties:
                    data:
                      items:
                        $ref: '#/components/schemas/Finding'
                      type: array
                  type: object
          description: List of Findings
      summary: Get a list of findings in assessment
      tags:
      - assessment
      x-openapi-router-controller: sarna.routes.api.controller.assessment_controller
    post:
      operationId: add_assessment_finding
      parameters:
      - description: Assessment ID
        explode: false
        in: path
        name: assessment_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FindingRequestBody'
        description: The finding to be created.
        required: true
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        201:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/Envelop'
                - properties:
                    data:
                      $ref: '#/components/schemas/Finding'
                  type: object
          description: Finding data
      summary: Add a new finding to the assessment
      tags:
      - assessment
      x-openapi-router-controller: sarna.routes.api.controller.assessment_controller
  /assessment/{assessment_id}/findig/{finding_id}:
    delete:
      operationId: delete_assessment_finding
      parameters:
      - description: Assessment ID
        explode: false
        in: path
        name: assessment_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      - description: Finding ID
        explode: false
        in: path
        name: finding_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        204:
          description: No Content
      summary: Delete Assessment Finding
      tags:
      - assessment
      x-openapi-router-controller: sarna.routes.api.controller.assessment_controller
    patch:
      operationId: edit_assessment_finding
      parameters:
      - description: Assessment ID
        explode: false
        in: path
        name: assessment_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      - description: Finding ID
        explode: false
        in: path
        name: finding_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FindingRequestBody'
        description: The finding to be edited.
        required: true
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        200:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/Envelop'
                - properties:
                    data:
                      $ref: '#/components/schemas/Finding'
                  type: object
          description: Finding data
      summary: Edit finding in the assessment
      tags:
      - assessment
      x-openapi-router-controller: sarna.routes.api.controller.assessment_controller
  /assessment/{assessment_id}/image:
    get:
      operationId: get_assessment_images
      parameters:
      - description: Assessment ID
        explode: false
        in: path
        name: assessment_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        200:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/PaginatedEnvelop'
                - properties:
                    data:
                      items:
                        $ref: '#/components/schemas/Image'
                      type: array
                  type: object
          description: List of Images
      summary: Get list of images
      tags:
      - assessment
      x-openapi-router-controller: sarna.routes.api.controller.assessment_controller
    post:
      operationId: add_assessment_image
      parameters:
      - description: Assessment ID
        explode: false
        in: path
        name: assessment_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      requestBody:
        content:
          multipart/form-data:
            schema:
              allOf:
              - $ref: '#/components/schemas/Image'
              - properties:
                  file:
                    format: binary
                    type: string
                type: object
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        204:
          description: No Content
      summary: Add evidence to assessment
      tags:
      - assessment
      x-openapi-router-controller: sarna.routes.api.controller.assessment_controller
  /assessment/{assessment_id}/image/{filename}:
    delete:
      operationId: delete_assessment_image
      parameters:
      - description: Assessment ID
        explode: false
        in: path
        name: assessment_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      - description: Filename
        explode: false
        in: path
        name: filename
        required: true
        schema:
          type: string
        style: simple
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        204:
          description: No Content
      summary: Delete Assessment image
      tags:
      - assessment
      x-openapi-router-controller: sarna.routes.api.controller.assessment_controller
    get:
      operationId: get_assessment_image
      parameters:
      - description: Assessment ID
        explode: false
        in: path
        name: assessment_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      - description: Filename
        explode: false
        in: path
        name: filename
        required: true
        schema:
          type: string
        style: simple
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        200:
          content:
            image/*:
              schema:
                format: binary
                type: string
          description: File data
      summary: Download assessment image
      tags:
      - assessment
      x-openapi-router-controller: sarna.routes.api.controller.assessment_controller
  /findign:
    get:
      operationId: get_findign_templates
      parameters:
      - description: Number of page
        explode: true
        in: query
        name: page
        required: false
        schema:
          default: 0
          format: int32
          minimum: 0
          type: integer
        style: form
      - description: Number of items returned
        explode: true
        in: query
        name: page_size
        required: false
        schema:
          default: 10
          format: int32
          maximum: 100
          minimum: 10
          multipleOf: 10
          type: integer
        style: form
      responses:
        200:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/PaginatedEnvelop'
                - properties:
                    data:
                      items:
                        $ref: '#/components/schemas/FindingTemplate'
                      type: array
                  type: object
          description: List of Finding Templates
      summary: Get a list of finding templates
      tags:
      - finding
      x-openapi-router-controller: sarna.routes.api.controller.finding_controller
  /finding/{finding_id}:
    delete:
      operationId: delete_finding_template
      parameters:
      - description: Finding ID
        explode: false
        in: path
        name: finding_id
        required: true
        schema:
          format: int32
          type: integer
        style: simple
      responses:
        404:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: The specified resource was not found
        403:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Envelop'
          description: Forbidden
        204:
          description: No Content
      summary: Delete Finding Template
      tags:
      - assessment
      x-openapi-router-controller: sarna.routes.api.controller.assessment_controller
  /user:
    get:
      operationId: get_users
      parameters:
      - description: Number of page
        explode: true
        in: query
        name: page
        required: false
        schema:
          default: 0
          format: int32
          minimum: 0
          type: integer
        style: form
      - description: Number of items returned
        explode: true
        in: query
        name: page_size
        required: false
        schema:
          default: 10
          format: int32
          maximum: 100
          minimum: 10
          multipleOf: 10
          type: integer
        style: form
      responses:
        200:
          content:
            application/json:
              schema:
                allOf:
                - $ref: '#/components/schemas/PaginatedEnvelop'
                - properties:
                    data:
                      items:
                        $ref: '#/components/schemas/User'
                      type: array
                  type: object
          description: List of Users
      summary: Get a list of Users
      tags:
      - user
      x-openapi-router-controller: sarna.routes.api.controller.user_controller
components:
  parameters:
    filename:
      description: Filename
      explode: false
      in: path
      name: filename
      required: true
      schema:
        type: string
      style: simple
    username:
      description: User ID
      explode: false
      in: path
      name: username
      required: true
      schema:
        type: string
      style: simple
    finding_id:
      description: Finding ID
      explode: false
      in: path
      name: finding_id
      required: true
      schema:
        format: int32
        type: integer
      style: simple
    assessment_id:
      description: Assessment ID
      explode: false
      in: path
      name: assessment_id
      required: true
      schema:
        format: int32
        type: integer
      style: simple
    client_id:
      description: Client ID
      explode: false
      in: path
      name: client_id
      required: true
      schema:
        format: int32
        type: integer
      style: simple
    page_size:
      description: Number of items returned
      explode: true
      in: query
      name: page_size
      required: false
      schema:
        default: 10
        format: int32
        maximum: 100
        minimum: 10
        multipleOf: 10
        type: integer
      style: form
    page:
      description: Number of page
      explode: true
      in: query
      name: page
      required: false
      schema:
        default: 0
        format: int32
        minimum: 0
        type: integer
      style: form
  responses:
    NotFound:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Envelop'
      description: The specified resource was not found
    Forbidden:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Envelop'
      description: Forbidden
    NoContent:
      description: No Content
  schemas:
    Error:
      properties:
        code:
          type: string
        message:
          type: string
      required:
      - code
      - message
      type: object
    Envelop:
      properties:
        data:
          type: object
        error:
          $ref: '#/components/schemas/Error'
      type: object
    PaginatedEnvelop:
      properties:
        total:
          description: Number of items
          example: 3212
          format: int32
          type: integer
        page_size:
          description: number of items per page
          example: 10
          format: int32
          type: integer
        page:
          description: Current page number
          example: 0
          format: int32
          type: integer
        error:
          $ref: '#/components/schemas/Error'
        data:
          items:
            type: object
          type: array
      type: object
    UserType:
      enum:
      - manager
      - auditor
      - trusted_auditor
      - admin
      example: manager
      type: string
    AssessmentType:
      enum:
      - Web
      - External_pentest
      - Mobile
      - iOS
      - Android
      - WiFi
      example: Web
      type: string
    AssessmentStatus:
      enum:
      - Open
      - Closed
      - Archived
      example: Open
      type: string
    FindingType:
      enum:
      - Web
      - Infra
      - Mobile
      - WiFi
      example: Web
      type: string
    FindingStatus:
      enum:
      - Pending
      - Reviewed
      - Confirmed
      - False_Positive
      - Other
      example: Pending
      type: string
    Language:
      enum:
      - Spanish
      - English
      example: Spanish
      type: string
    Score:
      enum:
      - Info
      - Low
      - Medium
      - High
      - Critical
      - NA
      example: Low
      type: string
    OWASPMobileTop10Category:
      enum:
      - M1
      - M2
      - M3
      - M4
      - M5
      - M6
      - M7
      - M8
      - M9
      - M10
      example: M1
      type: string
    OWISAMCategory:
      enum:
      - DI_001
      - DI_002
      - DI_003
      - DI_004
      - DI_005
      - DI_006
      - FP_001
      - FP_002
      - FP_003
      - FP_004
      - FP_005
      - FP_006
      - AU_001
      - AU_002
      - AU_003
      - AU_004
      - AU_005
      - AU_006
      - AU_007
      - AU_008
      - CP_001
      - CP_002
      - CP_003
      - CP_004
      - CP_005
      - CP_006
      - CF_001
      - CF_002
      - CF_003
      - CF_004
      - CF_005
      - CF_006
      - IF_001
      - IF_002
      - IF_003
      - IF_004
      - IF_005
      - IF_006
      - IF_007
      - IF_008
      - IF_009
      - IF_010
      - DS_001
      - DS_002
      - DS_003
      - DS_004
      - DS_005
      - GD_001
      - GD_002
      - GD_003
      - GD_004
      - GD_005
      - GD_006
      - CT_001
      - CT_002
      - CT_003
      - CT_004
      - CT_005
      - CT_006
      - CT_007
      - HS_001
      - HS_002
      - HS_003
      - HS_004
      example: DI-001
      type: string
    OWASPCategory:
      enum:
      - OTG_INFO_001
      - OTG_INFO_002
      - OTG_INFO_003
      - OTG_INFO_004
      - OTG_INFO_005
      - OTG_INFO_006
      - OTG_INFO_007
      - OTG_INFO_008
      - OTG_INFO_009
      - OTG_INFO_010
      - OTG_CONFIG_001
      - OTG_CONFIG_002
      - OTG_CONFIG_003
      - OTG_CONFIG_004
      - OTG_CONFIG_005
      - OTG_CONFIG_006
      - OTG_CONFIG_007
      - OTG_CONFIG_008
      - OTG_IDENT_001
      - OTG_IDENT_002
      - OTG_IDENT_003
      - OTG_IDENT_004
      - OTG_IDENT_005
      - OTG_IDENT_006
      - OTG_IDENT_007
      - OTG_AUTHN_001
      - OTG_AUTHN_002
      - OTG_AUTHN_003
      - OTG_AUTHN_004
      - OTG_AUTHN_005
      - OTG_AUTHN_006
      - OTG_AUTHN_007
      - OTG_AUTHN_008
      - OTG_AUTHN_009
      - OTG_AUTHN_010
      - OTG_AUTHZ_001
      - OTG_AUTHZ_002
      - OTG_AUTHZ_003
      - OTG_AUTHZ_004
      - OTG_SESS_001
      - OTG_SESS_002
      - OTG_SESS_003
      - OTG_SESS_004
      - OTG_SESS_005
      - OTG_SESS_006
      - OTG_SESS_007
      - OTG_SESS_008
      - OTG_INPVAL_001
      - OTG_INPVAL_002
      - OTG_INPVAL_003
      - OTG_INPVAL_004
      - OTG_INPVAL_005
      - OTG_INPVAL_006
      - OTG_INPVAL_007
      - OTG_INPVAL_008
      - OTG_INPVAL_009
      - OTG_INPVAL_010
      - OTG_INPVAL_011
      - OTG_INPVAL_012
      - OTG_INPVAL_013
      - OTG_INPVAL_014
      - OTG_INPVAL_015
      - OTG_INPVAL_016
      - OTG_ERR_001
      - OTG_ERR_002
      - OTG_CRYPST_001
      - OTG_CRYPST_002
      - OTG_CRYPST_003
      - OTG_BUSLOGIC_001
      - OTG_BUSLOGIC_002
      - OTG_BUSLOGIC_003
      - OTG_BUSLOGIC_004
      - OTG_BUSLOGIC_005
      - OTG_BUSLOGIC_006
      - OTG_BUSLOGIC_007
      - OTG_BUSLOGIC_008
      - OTG_BUSLOGIC_009
      - OTG_CLIENT_001
      - OTG_CLIENT_002
      - OTG_CLIENT_003
      - OTG_CLIENT_004
      - OTG_CLIENT_005
      - OTG_CLIENT_006
      - OTG_CLIENT_007
      - OTG_CLIENT_008
      - OTG_CLIENT_009
      - OTG_CLIENT_010
      - OTG_CLIENT_011
      - OTG_CLIENT_012
      example: OTG-INFO-001
      type: string
    FindingTemplateBase:
      properties:
        name:
          example: xss-vulne-stored
          maxLength: 64
          type: string
      required:
      - name
      type: object
    FindingTemplateResume:
      allOf:
      - $ref: '#/components/schemas/FindingTemplateBase'
      - properties:
          id:
            example: 1
            format: int32
            type: integer
        type: object
    FindingTemplateCreate:
      allOf:
      - $ref: '#/components/schemas/FindingTemplateBase'
      - properties:
          type:
            $ref: '#/components/schemas/FindingType'
          owasp_category:
            $ref: '#/components/schemas/OWASPCategory'
          owasp_mobile_category:
            $ref: '#/components/schemas/OWASPMobileTop10Category'
          owisam_category:
            $ref: '#/components/schemas/OWISAMCategory'
          tech_risk:
            $ref: '#/components/schemas/Score'
          business_risk:
            $ref: '#/components/schemas/Score'
          exploitability:
            $ref: '#/components/schemas/Score'
          dissemination:
            $ref: '#/components/schemas/Score'
          solution_complexity:
            $ref: '#/components/schemas/Score'
          lang:
            $ref: '#/components/schemas/Language'
          title:
            maxLength: 128
            type: string
          definition:
            type: string
          references:
            type: string
          description:
            type: string
        required:
        - business_risk
        - definition
        - dissemination
        - exploitability
        - lang
        - references
        - solution_complexity
        - tech_risk
        - title
        - type
        type: object
    FindingTemplate:
      allOf:
      - $ref: '#/components/schemas/FindingTemplateBase'
      - properties:
          type:
            $ref: '#/components/schemas/FindingType'
          owasp_category:
            $ref: '#/components/schemas/OWASPCategory'
          owasp_mobile_category:
            $ref: '#/components/schemas/OWASPMobileTop10Category'
          owisam_category:
            $ref: '#/components/schemas/OWISAMCategory'
          tech_risk:
            $ref: '#/components/schemas/Score'
          business_risk:
            $ref: '#/components/schemas/Score'
          exploitability:
            $ref: '#/components/schemas/Score'
          dissemination:
            $ref: '#/components/schemas/Score'
          solution_complexity:
            $ref: '#/components/schemas/Score'
          creator:
            $ref: '#/components/schemas/User'
        required:
        - business_risk
        - dissemination
        - exploitability
        - solution_complexity
        - tech_risk
        - type
        type: object
    FindingBase:
      properties:
        title:
          maxLength: 128
          type: string
        status:
          $ref: '#/components/schemas/FindingStatus'
        type:
          $ref: '#/components/schemas/FindingType'
        owasp_category:
          $ref: '#/components/schemas/OWASPCategory'
        owasp_mobile_category:
          $ref: '#/components/schemas/OWASPMobileTop10Category'
        owisam_category:
          $ref: '#/components/schemas/OWISAMCategory'
        tech_risk:
          $ref: '#/components/schemas/Score'
        business_risk:
          $ref: '#/components/schemas/Score'
        exploitability:
          $ref: '#/components/schemas/Score'
        dissemination:
          $ref: '#/components/schemas/Score'
        solution_complexity:
          $ref: '#/components/schemas/Score'
      type: object
    FindingResume:
      properties:
        id:
          example: 1
          format: int32
          type: integer
        name:
          maxLength: 60
          type: string
        title:
          maxLength: 128
          type: string
      type: object
    FindingRequestBody:
      allOf:
      - $ref: '#/components/schemas/FindingBase'
      - properties:
          template:
            example: xss-vulne-stored
            maxLength: 64
            type: string
        type: object
    Finding:
      allOf:
      - $ref: '#/components/schemas/FindingBase'
      - properties:
          id:
            example: 1
            format: int32
            type: integer
          name:
            maxLength: 60
            type: string
          template:
            $ref: '#/components/schemas/FindingTemplateResume'
          description:
            type: string
          solution:
            type: string
          definition:
            type: string
          references:
            type: string
          cvss_v3_vector:
            maxLength: 128
            type: string
        type: object
    AffectedResource:
      properties:
        route:
          maxLength: 256
          type: string
        findings:
          $ref: '#/components/schemas/FindingResume'
      type: object
    Active:
      properties:
        name:
          type: string
        active_resources:
          items:
            $ref: '#/components/schemas/AffectedResource'
          type: array
      type: object
    Image:
      properties:
        name:
          maxLength: 128
          type: string
      required:
      - name
      type: object
    ClientBase:
      properties:
        short_name:
          example: ACME
          maxLength: 64
          type: string
        long_name:
          example: ACME Global Corp Inc.
          maxLength: 128
          type: string
      required:
      - long_name
      - short_name
      type: object
    ClientRequestBody:
      allOf:
      - $ref: '#/components/schemas/ClientBase'
      - properties:
          managers:
            items:
              $ref: '#/components/schemas/UserName'
            type: array
        type: object
    Client:
      allOf:
      - $ref: '#/components/schemas/ClientBase'
      - properties:
          id:
            example: 1
            format: int32
            type: integer
          creator:
            $ref: '#/components/schemas/User'
          managers:
            items:
              $ref: '#/components/schemas/User'
            type: array
        required:
        - id
        type: object
    Template:
      properties:
        name:
          example: MY TEMPLATE
          maxLength: 25
          type: string
        description:
          example: This is the template description
          maxLength: 128
          type: string
      type: object
    AssessmentBase:
      properties:
        name:
          example: assessment-1
          maxLength: 64
          type: string
        platform:
          example: example.com
          maxLength: 64
          type: string
        lang:
          $ref: '#/components/schemas/Language'
        type:
          $ref: '#/components/schemas/AssessmentType'
        status:
          $ref: '#/components/schemas/AssessmentStatus'
      type: object
    AssessmentRequestBody:
      allOf:
      - $ref: '#/components/schemas/AssessmentBase'
      - properties:
          auditors:
            items:
              $ref: '#/components/schemas/UserName'
            type: array
        type: object
    Assessment:
      allOf:
      - $ref: '#/components/schemas/AssessmentBase'
      - properties:
          id:
            example: 1
            format: int32
            type: integer
          creator:
            $ref: '#/components/schemas/User'
          auditors:
            items:
              $ref: '#/components/schemas/User'
            type: array
          creation_date:
            format: date-time
            type: string
        type: object
    UserName:
      example: username
      maxLength: 128
      type: string
    User:
      properties:
        username:
          example: username
          maxLength: 128
          type: string
        user_type:
          $ref: '#/components/schemas/UserType'
      required:
      - username
      type: object
  securitySchemes:
    bearerAuth:
      scheme: bearer
      type: http
      x-bearerInfoFunc: sarna.core.auth.bearer_token_info
